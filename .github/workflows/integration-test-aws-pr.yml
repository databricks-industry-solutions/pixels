name: AWS integration test PR

on:
  pull_request:

jobs:
  run-databricks-notebook:
    runs-on: html_publisher
    steps:
      - name: Checkout repo
        uses: actions/checkout@v2
      - name: Run a databricks notebook
        uses: databricks/run-notebook@v0
        with:
          local-notebook-path: 01-dcm-demo.py
          git-commit: ${{ github.event.pull_request.head.sha }}
          databricks-host: https://e2-demo-west.cloud.databricks.com
          databricks-token: ${{ secrets.DEPLOYMENT_TARGET_TOKEN_AWS }}
          notebook-params-json: >
            {
              "table": "main.pixels_solacc_github_testsv20250706.object_catalog",
              "volume": "main.pixels_solacc_github_testsv20250706.pixels_volume"
            }
          access-control-list-json: >
            [
              {
                "group_name": "users",
                "permission_level": "CAN_MANAGE"
              }
            ]
