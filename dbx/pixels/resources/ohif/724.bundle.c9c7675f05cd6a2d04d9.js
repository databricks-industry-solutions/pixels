"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[724],{28724:(o,e,t)=>{t.r(e),t.d(e,{default:()=>A});var n=t(14283),i=t(21683);const s={CT:"ctToolGroup",PT:"ptToolGroup",Fusion:"fusionToolGroup",MIP:"mipToolGroup",default:"default"};const a=function(o,e,t,n){!function(o,e,t,n){const i={active:[{toolName:o.WindowLevel,bindings:[{mouseButton:e.MouseBindings.Primary}]},{toolName:o.Pan,bindings:[{mouseButton:e.MouseBindings.Auxiliary}]},{toolName:o.Zoom,bindings:[{mouseButton:e.MouseBindings.Secondary}]},{toolName:o.StackScrollMouseWheel,bindings:[]}],passive:[{toolName:o.Length},{toolName:o.ArrowAnnotate,configuration:{getTextCallback:(o,e)=>{n.runCommand("arrowTextCallback",{callback:o,eventDetails:e})},changeTextCallback:(o,e,t)=>n.runCommand("arrowTextCallback",{callback:t,data:o,eventDetails:e})}},{toolName:o.Bidirectional},{toolName:o.DragProbe},{toolName:o.Probe},{toolName:o.EllipticalROI},{toolName:o.RectangleROI},{toolName:o.StackScroll},{toolName:o.Angle},{toolName:o.CobbAngle},{toolName:o.Magnify}],enabled:[{toolName:o.SegmentationDisplay}],disabled:[{toolName:o.Crosshairs,configuration:{viewportIndicators:!1,autoPan:{enabled:!1,panSize:10}}}]};t.createToolGroupAndAddTools(s.CT,i),t.createToolGroupAndAddTools(s.PT,{active:i.active,passive:[...i.passive,{toolName:"RectangleROIStartEndThreshold"}],enabled:i.enabled,disabled:i.disabled}),t.createToolGroupAndAddTools(s.Fusion,i),t.createToolGroupAndAddTools(s.default,i);const a={active:[{toolName:o.VolumeRotateMouseWheel,configuration:{rotateIncrementDegrees:5}},{toolName:o.MipJumpToClick,configuration:{toolGroupId:s.PT},bindings:[{mouseButton:e.MouseBindings.Primary}]}],enabled:[{toolName:o.SegmentationDisplay}]};t.createToolGroupAndAddTools(s.MIP,a)}(o,e,t,n)},{windowLevelPresets:l}=n.defaults;function r(o,e,t,n,i,s){return{id:e,icon:t,label:n,type:o,commands:i,tooltip:s}}function d(o,e){return{id:o,label:o,type:"action",commands:[{commandName:"setFusionPTColormap",commandOptions:{toolGroupId:s.Fusion,colormap:e}}]}}r.bind(null,"action"),r.bind(null,"toggle");const c=r.bind(null,"tool");function u(o,e,t){return{id:o.toString(),title:e,subtitle:t,type:"action",commands:[{commandName:"setWindowLevel",commandOptions:{...l[o]},context:"CORNERSTONE"}]}}function m(o,e,t){return t.map((t=>({commandName:o,commandOptions:{toolName:e,toolGroupId:t},context:"CORNERSTONE"})))}const p=[{id:"MeasurementTools",type:"ohif.splitButton",props:{groupId:"MeasurementTools",isRadio:!0,primary:c("Length","tool-length","Length",[...m("setToolActive","Length",[s.CT,s.PT,s.Fusion])],"Length"),secondary:{icon:"chevron-down",label:"",isActive:!0,tooltip:"More Measure Tools"},items:[c("Length","tool-length","Length",[...m("setToolActive","Length",[s.CT,s.PT,s.Fusion])],"Length Tool"),c("Bidirectional","tool-bidirectional","Bidirectional",[...m("setToolActive","Bidirectional",[s.CT,s.PT,s.Fusion])],"Bidirectional Tool"),c("ArrowAnnotate","tool-annotate","Annotation",[...m("setToolActive","ArrowAnnotate",[s.CT,s.PT,s.Fusion])],"Arrow Annotate"),c("EllipticalROI","tool-elipse","Ellipse",[...m("setToolActive","EllipticalROI",[s.CT,s.PT,s.Fusion])],"Ellipse Tool")]}},{id:"Zoom",type:"ohif.radioGroup",props:{type:"tool",icon:"tool-zoom",label:"Zoom",commands:[...m("setToolActive","Zoom",[s.CT,s.PT,s.Fusion])]}},{id:"MPR",type:"ohif.action",props:{type:"toggle",icon:"icon-mpr",label:"MPR",commands:[{commandName:"toggleHangingProtocol",commandOptions:{protocolId:"mpr"},context:"DEFAULT"}]}},{id:"WindowLevel",type:"ohif.splitButton",props:{groupId:"WindowLevel",primary:c("WindowLevel","tool-window-level","Window Level",[...m("setToolActive","WindowLevel",[s.CT,s.PT,s.Fusion])],"Window Level"),secondary:{icon:"chevron-down",label:"W/L Manual",isActive:!0,tooltip:"W/L Presets"},isAction:!0,renderer:i.d4,items:[u(1,"Soft tissue","400 / 40"),u(2,"Lung","1500 / -600"),u(3,"Liver","150 / 90"),u(4,"Bone","2500 / 480"),u(5,"Brain","80 / 40")]}},{id:"Crosshairs",type:"ohif.radioGroup",props:{type:"tool",icon:"tool-crosshair",label:"Crosshairs",commands:[...m("setToolActive","Crosshairs",[s.CT,s.PT,s.Fusion])]}},{id:"Pan",type:"ohif.radioGroup",props:{type:"tool",icon:"tool-move",label:"Pan",commands:[...m("setToolActive","Pan",[s.CT,s.PT,s.Fusion])]}},{id:"RectangleROIStartEndThreshold",type:"ohif.radioGroup",props:{type:"tool",icon:"tool-create-threshold",label:"Rectangle ROI Threshold",commands:[...m("setToolActive","RectangleROIStartEndThreshold",[s.PT]),{commandName:"displayNotification",commandOptions:{title:"RectangleROI Threshold Tip",text:"RectangleROI Threshold tool should be used on PT Axial Viewport",type:"info"}},{commandName:"setViewportActive",commandOptions:{viewportId:"ptAXIAL"}}]}},{id:"fusionPTColormap",type:"ohif.splitButton",props:{groupId:"fusionPTColormap",primary:c("fusionPTColormap","tool-fusion-color","Fusion PT Colormap",[],"Fusion PT Colormap"),secondary:{icon:"chevron-down",label:"PT Colormap",isActive:!0,tooltip:"PET Image Colormap"},isAction:!0,items:[d("HSV","hsv"),d("Hot Iron","hot_iron"),d("S PET","s_pet"),d("Red Hot","red_hot"),d("Perfusion","perfusion"),d("Rainbow","rainbow_2"),d("SUV","suv"),d("GE 256","ge_256"),d("GE","ge"),d("Siemens","siemens")]}}],T=JSON.parse('{"UU":"@ohif/mode-tmtv"}').UU;var g=t(92344);const{MetadataProvider:h}=n.classes,v="@ohif/extension-default.layoutTemplateModule.viewerLayout",f="@ohif/extension-default.sopClassHandlerModule.stack",y="@ohif/extension-default.panelModule.seriesList",C="@ohif/extension-cornerstone.viewportModule.cornerstone",b="@ohif/extension-tmtv.hangingProtocolModule.ptCT",P="@ohif/extension-tmtv.panelModule.petSUV",S="@ohif/extension-tmtv.panelModule.ROIThresholdSeg",I={"@ohif/extension-default":"^3.0.0","@ohif/extension-cornerstone":"^3.0.0","@ohif/extension-tmtv":"^3.0.0"};let N=[];const A={id:T,modeFactory:function({modeConfiguration:o}){return{id:T,routeName:"tmtv",displayName:g.A.t("Modes:Total Metabolic Tumor Volume"),onModeEnter:({servicesManager:o,extensionManager:e,commandsManager:t})=>{const{toolbarService:n,toolGroupService:i,hangingProtocolService:l,displaySetService:r}=o.services,d=e.getModuleEntry("@ohif/extension-cornerstone.utilityModule.tools"),{toolNames:c,Enums:u}=d.exports;a(c,u,i,t);const{unsubscribe:m}=i.subscribe(i.EVENTS.VIEWPORT_ADDED,(()=>{const{displaySetMatchDetails:o}=l.getMatchDetails();!function(o,e,t,n){const i=o.get("ctDisplaySet");if(!i)return;const{SeriesInstanceUID:a}=i,l=n.getDisplaySetsForSeries(a),r={...t.getToolConfiguration(s.Fusion,e.Crosshairs),filterActorUIDsToSetSlabThickness:[l[0].displaySetInstanceUID]};t.setToolConfiguration(s.Fusion,e.Crosshairs,r)}(o,c,i,r),function(o,e,t,n){const i=o.get("ptDisplaySet");if(!i)return;const{SeriesInstanceUID:a}=i,l=n.getDisplaySetsForSeries(a);if(!l||0===l.length)return;const r=t.getToolConfiguration(s.Fusion,e.WindowLevel),d=t.getToolConfiguration(s.Fusion,e.EllipticalROI),c=`cornerstoneStreamingImageVolume:${l[0].displaySetInstanceUID}`,u={...r,volumeId:c},m={...d,volumeId:c};t.setToolConfiguration(s.Fusion,e.WindowLevel,u),t.setToolConfiguration(s.Fusion,e.EllipticalROI,m)}(o,c,i,r),n.recordInteraction({groupId:"WindowLevel",interactionType:"tool",commands:[{commandName:"setToolActive",commandOptions:{toolName:c.WindowLevel,toolGroupId:s.CT},context:"CORNERSTONE"},{commandName:"setToolActive",commandOptions:{toolName:c.WindowLevel,toolGroupId:s.PT},context:"CORNERSTONE"},{commandName:"setToolActive",commandOptions:{toolName:c.WindowLevel,toolGroupId:s.Fusion},context:"CORNERSTONE"}]})}));N.push(m),n.init(e),n.addButtons(p),n.createButtonSection("primary",["MeasurementTools","Zoom","WindowLevel","Crosshairs","Pan","RectangleROIStartEndThreshold","fusionPTColormap"]),l.addCustomAttribute("getPTVOIRange","get PT VOI based on corrected or not",(o=>{const e=o.find((o=>"PT"===o.Modality));if(!e)return;const{imageId:t}=e.images[0],n=h.get("scalingModule",t);return n&&n.suvbw?{windowWidth:5,windowCenter:2.5}:void 0}))},onModeExit:({servicesManager:o})=>{const{toolGroupService:e,syncGroupService:t,segmentationService:n,cornerstoneViewportService:i}=o.services;N.forEach((o=>o())),e.destroy(),t.destroy(),n.destroy(),i.destroy()},validationTags:{study:[],series:[]},isValidMode:({modalities:o,study:e})=>{const t=o.split("\\");return t.includes("CT")&&t.includes("PT")&&!["SM"].some((o=>t.includes(o)))&&"1.3.6.1.4.1.12842.1.1.14.3.20220915.105557.468.2963630849"!==e.studyInstanceUid},routes:[{path:"tmtv",layoutTemplate:({location:o,servicesManager:e})=>({id:v,props:{leftPanels:[y],leftPanelDefaultClosed:!0,rightPanels:[S,P],viewports:[{namespace:C,displaySetsToDisplay:[f]}]}})}],extensions:I,hangingProtocol:b,sopClassHandlers:[f],hotkeys:[...n.ot.defaults.hotkeyBindings],...o}},extensionDependencies:I}}}]);
//# sourceMappingURL=724.bundle.c9c7675f05cd6a2d04d9.js.map