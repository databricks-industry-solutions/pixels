"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[889],{1889:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var r=n(41766),i=n(78668),o=n(11374),a=n.n(o),s=n(20767),l=n(50719),c=n(14283),m=n(21683),u=n(71353);function p({viewportData:e,viewportId:t,element:n,imageSliceData:i,setImageSliceData:o,scrollbarHeight:a,servicesManager:c}){const{cineService:u,cornerstoneViewportService:p}=c.services;return(0,r.useEffect)((()=>{if(!e)return;const n=p.getCornerstoneViewport(t);if(n)if(e.viewportType!==l.Enums.ViewportType.STACK){if(e.viewportType===l.Enums.ViewportType.ORTHOGRAPHIC){const e=l.utilities.getImageSliceDataForVolumeViewport(n);if(!e)return;const{imageIndex:t,numberOfSlices:r}=e;o({imageIndex:t,numberOfSlices:r})}}else{const t=n.getCurrentImageIdIndex();o({imageIndex:t,numberOfSlices:e.data.imageIds.length})}}),[t,e]),(0,r.useEffect)((()=>{if(e?.viewportType!==l.Enums.ViewportType.STACK)return;const t=t=>{const{newImageIdIndex:n}=t.detail;o({imageIndex:n,numberOfSlices:e.data.imageIds.length})};return n.addEventListener(l.Enums.Events.STACK_VIEWPORT_SCROLL,t),()=>{n.removeEventListener(l.Enums.Events.STACK_VIEWPORT_SCROLL,t)}}),[e,n]),(0,r.useEffect)((()=>{if(e?.viewportType!==l.Enums.ViewportType.ORTHOGRAPHIC)return;const t=e=>{const{imageIndex:t,numberOfSlices:n}=e.detail;o({imageIndex:t,numberOfSlices:n})};return n.addEventListener(l.Enums.Events.VOLUME_NEW_IMAGE,t),()=>{n.removeEventListener(l.Enums.Events.VOLUME_NEW_IMAGE,t)}}),[e,n]),r.createElement(m.uq,{onChange:e=>((e,t)=>{const r=p.getCornerstoneViewport(t),{isCineEnabled:i}=u.getState();i&&(u.stopClip(n),u.setCine({id:t,isPlaying:!1})),s.utilities.jumpToSlice(r.element,{imageIndex:e,debounceLoading:!0})})(e,t),max:i.numberOfSlices?i.numberOfSlices-1:0,height:a,value:i.imageIndex})}p.propTypes={viewportData:a().object,viewportId:a().string.isRequired,element:a().instanceOf(Element),scrollbarHeight:a().string,imageSliceData:a().object.isRequired,setImageSliceData:a().func.isRequired,servicesManager:a().object.isRequired};const d=p;var v=n(83636),f=n(8291),g=n.n(f);function E(e,t=0){if(null!==e)return parseFloat(e).toFixed(t)}function I(e,t="MMM D, YYYY"){return g()(e,"YYYYMMDD").format(t)}function w(e,t="HH:mm:ss"){return g()(e,"HH:mm:ss").format(t)}function S(e){if(!e)return"";const t=e.split("^").filter((e=>!!e)).join(", ").trim();return","===t||""===t?"":t}const y=1e-4;function b({voi:e,customization:t}){const{windowWidth:n,windowCenter:i}=e;return"number"!=typeof i||"number"!=typeof n?null:r.createElement("div",{className:"overlay-item flex flex-row",style:{color:t&&t.color||void 0}},r.createElement("span",{className:"mr-1 shrink-0"},"W:"),r.createElement("span",{className:"ml-1 mr-2 shrink-0 font-light"},n.toFixed(0)),r.createElement("span",{className:"mr-1 shrink-0"},"L:"),r.createElement("span",{className:"ml-1 shrink-0 font-light"},i.toFixed(0)))}function T({scale:e,customization:t}){return r.createElement("div",{className:"overlay-item flex flex-row",style:{color:t&&t.color||void 0}},r.createElement("span",{className:"mr-1 shrink-0"},"Zoom:"),r.createElement("span",{className:"font-light"},e.toFixed(2),"x"))}function h({instanceNumber:e,imageSliceData:t,customization:n}){const{imageIndex:i,numberOfSlices:o}=t;return r.createElement("div",{className:"overlay-item flex flex-row",style:{color:n&&n.color||void 0}},r.createElement("span",{className:"mr-1 shrink-0"},"I:"),r.createElement("span",{className:"font-light"},null!=e?`${e} (${i+1}/${o})`:`${i+1}/${o}`))}function C({element:e,viewportData:t,imageSliceData:n,viewportId:i,servicesManager:o}){const{toolbarService:a,cornerstoneViewportService:s,customizationService:c}=o.services,[u,p]=(0,r.useState)({windowCenter:null,windowWidth:null}),[d,v]=(0,r.useState)(1),[f,g]=(0,r.useState)([]),{imageIndex:y}=n,C=c.getModeCustomization("cornerstoneOverlayTopLeft"),D=c.getModeCustomization("cornerstoneOverlayTopRight"),R=c.getModeCustomization("cornerstoneOverlayBottomLeft"),V=c.getModeCustomization("cornerstoneOverlayBottomRight"),M=(0,r.useMemo)((()=>null!=t?function(e,t){let n=null;if(e.viewportType===l.Enums.ViewportType.STACK)n=e.data.imageIds[t];else if(e.viewportType===l.Enums.ViewportType.ORTHOGRAPHIC){const r=e.data;if(r&&1==r.length){n=r[0].imageIds[t]}}return n&&l.metaData.get("instance",n)||{}}(t,y):null),[t,y]),N=(0,r.useMemo)((()=>null!=t?function(e,t,n,r){let i;if(e.viewportType===l.Enums.ViewportType.STACK){if(i=function(e,t){const n=e.data.imageIds,r=n[t];if(!r)return;const i=l.metaData.get("generalImageModule",r)||{},{instanceNumber:o}=i;if(n.length<=1)return;return parseInt(o)}(e,n),!i&&0!==i)return null}else e.viewportType===l.Enums.ViewportType.ORTHOGRAPHIC&&(i=O(e,n,t));return i}(t,i,y):null),[t,i,y,s]);(0,r.useEffect)((()=>{g(a.getActiveTools())}),[]),(0,r.useEffect)((()=>{const t=e=>{const{range:t}=e.detail;if(!t)return;const{lower:n,upper:r}=t,{windowWidth:i,windowCenter:o}=l.utilities.windowLevel.toWindowLevel(n,r);p({windowCenter:o,windowWidth:i})};return e.addEventListener(l.Enums.Events.VOI_MODIFIED,t),()=>{e.removeEventListener(l.Enums.Events.VOI_MODIFIED,t)}}),[i,t,u,e]),(0,r.useEffect)((()=>{const t=t=>{const{previousCamera:n,camera:r}=t.detail;if(n.parallelScale!==r.parallelScale||n.scale!==r.scale){const t=s.getCornerstoneViewport(i);if(!t)return;const n=t.getImageData();if(!n)return;if(r.scale)return void v(r.scale);const{spacing:o}=n,a=e.clientHeight*o[0]*.5/r.parallelScale;v(a)}};return e.addEventListener(l.Enums.Events.CAMERA_MODIFIED,t),()=>{e.removeEventListener(l.Enums.Events.CAMERA_MODIFIED,t)}}),[i,t,s,e]),(0,r.useEffect)((()=>{const{unsubscribe:e}=a.subscribe(a.EVENTS.TOOL_BAR_STATE_MODIFIED,(()=>{g(a.getActiveTools())}));return()=>{e()}}),[a]);const L=(0,r.useCallback)((a=>{const s={element:e,viewportData:t,imageSliceData:n,viewportId:i,servicesManager:o,customization:a,formatters:{formatPN:S,formatDate:I,formatTime:w,formatNumberPrecision:E},instance:M,voi:u,scale:d,instanceNumber:N};if("ohif.overlayItem.windowLevel"===a.customizationType)return r.createElement(b,s);if("ohif.overlayItem.zoomLevel"===a.customizationType)return r.createElement(T,s);if("ohif.overlayItem.instanceNumber"===a.customizationType)return r.createElement(h,s);{const e=c.transform(a);if("function"==typeof e.content)return e.content(s)}}),[e,t,n,i,o,c,M,u,d,N]),A=(0,r.useCallback)((()=>{const e=C?.items||[{id:"WindowLevel",customizationType:"ohif.overlayItem.windowLevel"}];return r.createElement(r.Fragment,null,e.map(((e,t)=>r.createElement("div",{key:`topLeftOverlayItem_${t}`},L(e)))))}),[C,L]),P=(0,r.useCallback)((()=>{const e=D?.items||[{id:"InstanceNmber",customizationType:"ohif.overlayItem.instanceNumber"}];return r.createElement(r.Fragment,null,e.map(((e,t)=>r.createElement("div",{key:`topRightOverlayItem_${t}`},L(e)))))}),[D,L]),_=(0,r.useCallback)((()=>{const e=R?.items||[];return r.createElement(r.Fragment,null,e.map(((e,t)=>r.createElement("div",{key:`bottomLeftOverlayItem_${t}`},L(e)))))}),[R,L]),x=(0,r.useCallback)((()=>{const e=V?.items||[];return r.createElement(r.Fragment,null,e.map(((e,t)=>r.createElement("div",{key:`bottomRightOverlayItem_${t}`},L(e)))))}),[V,L]);return r.createElement(m.pU,{topLeft:A(),topRight:P(),bottomLeft:_(),bottomRight:x()})}function O(e,t,n){const r=e.volumes;if(!r||r.length>1)return;const i=r[0],{direction:o,imageIds:a}=i,s=n.getCornerstoneViewport(t);if(!s)return;const c=s.getCamera(),{viewPlaneNormal:m}=c,u=o.slice(6,9),p=v.eR.cross(v.eR.create(),m,u);if(v.eR.length(p)<y){const e=a[imageIndex];if(!e)return{};const{instanceNumber:t}=l.metaData.get("generalImageModule",e)||{};return parseInt(t)}}C.propTypes={viewportData:a().object,imageIndex:a().number,viewportId:a().string};const D=C;var R=n(61466),V=n.n(R);const{getOrientationStringLPS:M,invertOrientationStringLPS:N}=s.utilities.orientation;function L({element:e,viewportData:t,imageSliceData:n,viewportId:i,servicesManager:o,orientationMarkers:a=["top","left"]}){const[s,c]=(0,r.useState)(0),[m,u]=(0,r.useState)(!1),[p,d]=(0,r.useState)(!1),{cornerstoneViewportService:f}=o.services;(0,r.useEffect)((()=>{const t=e=>{const{rotation:t,previousCamera:n,camera:r}=e.detail;void 0!==t&&c(t),void 0!==r.flipHorizontal&&n.flipHorizontal!==r.flipHorizontal&&u(r.flipHorizontal),void 0!==r.flipVertical&&n.flipVertical!==r.flipVertical&&d(r.flipVertical)};return e.addEventListener(l.Enums.Events.CAMERA_MODIFIED,t),()=>{e.removeEventListener(l.Enums.Events.CAMERA_MODIFIED,t)}}),[]);const g=(0,r.useMemo)((()=>{if(!t)return"";let o,c;if("stack"===t.viewportType){const e=n.imageIndex,r=t.data.imageIds?.[e];if(!r)return!1;({rowCosines:o,columnCosines:c}=l.metaData.get("imagePlaneModule",r)||{})}else{if(!e||!(0,l.getEnabledElement)(e))return"";const{viewport:t}=(0,l.getEnabledElement)(e),{viewUp:n,viewPlaneNormal:r}=t.getCamera(),i=v.eR.create();v.eR.cross(i,n,r),c=[-n[0],-n[1],-n[2]],o=i}if(!o||!c||void 0===s)return"";const u=function(e,t,n,r,i){const o=M(e),a=M(t),s=N(o),l={top:N(a),left:s,right:o,bottom:a};r&&(l.top=N(l.top),l.bottom=N(l.bottom));i&&(l.left=N(l.left),l.right=N(l.right));if(90===n||-270===n)return{top:l.left,left:N(l.top),right:N(l.bottom),bottom:l.right};if(-90===n||270===n)return{top:N(l.left),left:l.top,bottom:l.left,right:l.bottom};if(180===n||-180===n)return{top:N(l.top),left:N(l.left),bottom:N(l.bottom),right:N(l.right)};return l}(o,c,s,p,m),d=f.getViewportInfo(i);if(!d)return console.log("ViewportOrientationMarkers::No viewport"),null;const g=d.getViewportOptions().background,E=!!g&&l.utilities.isEqual(g,[1,1,1]);return a.map(((e,t)=>r.createElement("div",{className:V()(`${e}-mid orientation-marker`,E?"text-[#726F7E]":"text-[#ccc]"),key:`${e}-mid orientation-marker`},r.createElement("div",{className:"orientation-marker-value"},u[e]))))}),[t,n,s,p,m,a,e]);return r.createElement("div",{className:"ViewportOrientationMarkers noselect"},g)}L.propTypes={percentComplete:a().number,error:a().object},L.defaultProps={percentComplete:0,error:null};const A=L;function P({viewportData:e,element:t}){const[n,i]=(0,r.useState)(!1),[o,a]=(0,r.useState)(!1),s=(0,r.useRef)(null),c=(0,r.useRef)(null),m=e=>{clearTimeout(s.current),s.current=setTimeout((()=>{i(!0)}),50)},u=e=>{clearTimeout(s.current),i(!1)},p=e=>{clearTimeout(s.current),c.current===e.detail.imageId&&(a(e.detail.error),c.current=null)};return(0,r.useEffect)((()=>(t.addEventListener(l.Enums.Events.STACK_VIEWPORT_SCROLL,m),t.addEventListener(l.Enums.Events.IMAGE_LOAD_ERROR,p),t.addEventListener(l.Enums.Events.STACK_NEW_IMAGE,u),()=>{t.removeEventListener(l.Enums.Events.STACK_VIEWPORT_SCROLL,m),t.removeEventListener(l.Enums.Events.STACK_NEW_IMAGE,u),t.removeEventListener(l.Enums.Events.IMAGE_LOAD_ERROR,p)})),[t,e]),o?r.createElement(r.Fragment,null,r.createElement("div",{className:"absolute top-0 left-0 h-full w-full bg-black opacity-50"},r.createElement("div",{className:"transparent flex h-full w-full items-center justify-center"},r.createElement("p",{className:"text-primary-light text-xl font-light"},r.createElement("h4",null,"Error Loading Image"),r.createElement("p",null,"An error has occurred."),r.createElement("p",null,o))))):n?r.createElement("div",{className:"pointer-events-none absolute top-0 left-0 h-full w-full bg-black opacity-50"},r.createElement("div",{className:"transparent flex h-full w-full items-center justify-center"},r.createElement("p",{className:"text-primary-light text-xl font-light"},"Loading..."))):null}P.propTypes={percentComplete:a().number,error:a().object,element:a().object},P.defaultProps={percentComplete:0,error:null};const _=P;const x=function(e){const{viewportId:t,element:n,scrollbarHeight:i,servicesManager:o}=e,{cornerstoneViewportService:a}=o.services,[s,l]=(0,r.useState)({imageIndex:0,numberOfSlices:0}),[c,m]=(0,r.useState)(null);if((0,r.useEffect)((()=>{const{unsubscribe:e}=a.subscribe(a.EVENTS.VIEWPORT_DATA_CHANGED,(e=>{e.viewportId===t&&m(e.viewportData)}));return()=>{e()}}),[t]),!n)return null;if(c){const e=a.getViewportInfo(t);if(e?.viewportOptions?.customViewportProps?.hideOverlays)return null}return r.createElement("div",{className:"noselect"},r.createElement(d,{viewportId:t,viewportData:c,element:n,imageSliceData:s,setImageSliceData:l,scrollbarHeight:i,servicesManager:o}),r.createElement(D,{imageSliceData:s,viewportData:c,viewportId:t,servicesManager:o,element:n}),r.createElement(_,{viewportData:c,element:n}),r.createElement(A,{imageSliceData:s,element:n,viewportData:c,servicesManager:o,viewportId:t}))};var k=n(1663),F=n(15575);const H=function({enabledVPElement:e,viewportId:t,servicesManager:n}){const{toolbarService:i,customizationService:o,displaySetService:a,viewportGridService:s,cineService:c}=n.services,[{isCineEnabled:u,cines:p}]=(0,m.tq)(),[d,v]=(0,r.useState)(24),[f]=(0,F.r)(),{component:g=m.F0}=o.get("cinePlayer")??{},E=()=>{if(!p||!p[t]||!e)return;const n=p[t],r=n.isPlaying||!1,i=n.frameRate||24,o=Math.max(i,1);r?c.playClip(e,{framesPerSecond:o}):c.stopClip(e)},I=(0,r.useCallback)((()=>{const{viewports:e}=s.getState(),{displaySetInstanceUIDs:n}=e.get(t);let r=24,i=p[t].isPlaying;n.forEach((e=>{const t=a.getDisplaySetByUID(e);t.FrameRate&&(r=Math.round(1e3/t.FrameRate),i||=!!f.autoPlayCine)})),i&&c.setIsCineEnabled(i),c.setCine({id:t,isPlaying:i,frameRate:r}),v(r)}),[c,a,t,s,p]);(0,r.useEffect)((()=>(l.eventTarget.addEventListener(l.Enums.Events.STACK_VIEWPORT_NEW_STACK,I),()=>{c.setCine({id:t,isPlaying:!1}),l.eventTarget.removeEventListener(l.Enums.Events.STACK_VIEWPORT_NEW_STACK,I)})),[e,I]),(0,r.useEffect)((()=>{if(p&&p[t]&&e)return E(),()=>{e&&p?.[t]?.isPlaying&&c.stopClip(e)}}),[p,t,c,e,E]);const w=p[t],S=w&&w.isPlaying||!1;return u&&r.createElement(g,{className:"absolute left-1/2 bottom-3 -translate-x-1/2",frameRate:d,isPlaying:S,onClose:()=>{i.recordInteraction({groupId:"MoreTools",interactionType:"toggle",commands:[{commandName:"toggleCine",commandOptions:{},toolName:"cine",context:"CORNERSTONE"}]})},onPlayPauseChange:e=>c.setCine({id:t,isPlaying:e}),onFrameRateChange:e=>c.setCine({id:t,frameRate:e})})};let z;function G(e,t){if(t.needsRerendering)return!1;if(e.displaySets.length!==t.displaySets.length)return!1;if(e.viewportOptions.orientation!==t.viewportOptions.orientation)return!1;if(e.viewportOptions.toolGroupId!==t.viewportOptions.toolGroupId)return!1;if(e.viewportOptions.viewportType!==t.viewportOptions.viewportType)return!1;if(t.viewportOptions.needsRerendering)return!1;const n=e.displaySets,r=t.displaySets;if(n.length!==r.length)return!1;for(let e=0;e<n.length;e++){const t=n[e],i=r.find((e=>e.displaySetInstanceUID===t.displaySetInstanceUID));if(!i)return!1;if(i.images?.length!==t.images?.length)return!1;if(i.images?.length)for(let e=0;e<i.images.length;e++)if(i.images[e].imageId!==t.images[e].imageId)return!1}return!0}const W=r.memo((e=>{const{displaySets:t,dataSource:n,viewportOptions:o,displaySetOptions:a,servicesManager:p,onElementEnabled:d,onElementDisabled:v,isJumpToMeasurementDisabled:f,initialImageIndex:g}=e,E=o.viewportId,[I,w]=(0,r.useState)("100px"),[S,y]=(0,r.useState)(null),b=(0,r.useRef)(),{measurementService:T,displaySetService:h,toolbarService:C,toolGroupService:O,syncGroupService:D,cornerstoneViewportService:R,cornerstoneCacheService:V,viewportGridService:M,stateSyncService:N}=p.services,[L]=(0,m.OR)(),A=(0,r.useCallback)((()=>{const e=b.current.clientHeight-20+"px";w(e)}),[b]),P=(0,r.useCallback)((()=>{b.current&&(R.resize(),A())}),[b]),_=(0,r.useCallback)((e=>{const t=e.getRenderingEngineId(),n=e.getSyncGroups();O.removeViewportFromToolGroup(E,t),D.removeViewportFromSyncGroup(E,t,n)}),[E]),k=(0,r.useCallback)((e=>{if(e.detail.element!==b.current)return;const{viewportId:t,element:n}=e.detail,r=R.getViewportInfo(t);(0,u.ye)(t,n),y(n);const i=r.getRenderingEngineId(),o=r.getToolGroupId(),a=r.getSyncGroups();O.addViewportToToolGroup(t,i,o),D.addViewportToSyncGroup(t,i,a);const s=N.getState().synchronizersStore;s?.[t]?.length&&function(e,t,n){e[t].forEach((e=>{if(!e.id)return;const{id:r,sourceViewports:i,targetViewports:o}=e,a=n.getSynchronizer(r);if(!a)return;const s=i.find((e=>e.viewportId===t)),l=o.find((e=>e.viewportId===t)),c=a.getSourceViewports().find((e=>e.viewportId===t)),m=a.getTargetViewports().find((e=>e.viewportId===t));s&&!c&&a.addSource({viewportId:s.viewportId,renderingEngineId:s.renderingEngineId}),l&&!m&&a.addTarget({viewportId:l.viewportId,renderingEngineId:l.renderingEngineId})}))}(s,t,D),d&&d(e)}),[E,d,O]);return(0,r.useEffect)((()=>(R.enableViewport(E,b.current),l.eventTarget.addEventListener(l.Enums.Events.ELEMENT_ENABLED,k),A(),()=>{const e=R.getViewportInfo(E);e&&(R.storePresentation({viewportId:E}),_(e),v&&v(e),R.disableElement(E),l.eventTarget.removeEventListener(l.Enums.Events.ELEMENT_ENABLED,k))})),[]),(0,r.useEffect)((()=>{const{unsubscribe:e}=h.subscribe(h.EVENTS.DISPLAY_SET_SERIES_METADATA_INVALIDATED,(async({displaySetInstanceUID:e,invalidateData:t})=>{if(!t)return;const r=R.getViewportInfo(E);if(r.hasDisplaySet(e)){const t=r.getViewportData(),i=await V.invalidateViewportData(t,e,n,h),o=!0;R.updateViewport(E,i,o)}}));return()=>{e()}}),[E]),(0,r.useEffect)((()=>{o.viewportType||(o.viewportType="stack");(async()=>{const e=await V.createViewportData(t,o,n,g),r=N.getState(),i=r.lutPresentationStore,l=r.positionPresentationStore,{presentationIds:c}=o,m={positionPresentation:l[c?.positionPresentationId],lutPresentation:i[c?.lutPresentationId]};let u;z?.viewportId===E&&(u=z.measurement,m.positionPresentation=null,z=null),o.needsRerendering&&(o.needsRerendering=!1),R.setViewportData(E,e,o,a,m),u&&s.annotation.selection.setAnnotationSelected(u.uid)})()}),[o,t,n]),(0,r.useEffect)((()=>{if(f)return;const e=function(e,t,n,r,i,o,a){const{unsubscribe:s}=e.subscribe(c.MeasurementService.EVENTS.JUMP_TO_MEASUREMENT_VIEWPORT,(i=>{z=i;const{viewportId:s,measurement:l,isConsumed:c}=i;l&&!c&&(void 0===z.cornerstoneViewport&&(z.cornerstoneViewport=a.getViewportIdToJump(s,l.displaySetInstanceUID,{referencedImageId:l.referencedImageId})),z.cornerstoneViewport===r&&U(l,n,r,e,t,o,a))}));return s}(T,h,b,E,0,M,R);return function(e,t,n,r,i,o,a){if(!z)return;if(z.isConsumed)return void(z=null);const s=i.map((e=>e.displaySetInstanceUID));if(!s?.length)return;const{measurement:l}=z;l&&n&&s.includes(l?.displaySetInstanceUID)&&U(l,n,r,e,t,o,a)}(T,h,b,E,t,M,R),()=>{e()}}),[t,b,E]),r.createElement(r.Fragment,null,r.createElement("div",{className:"viewport-wrapper"},r.createElement(i.Ay,{onResize:P,targetRef:b.current}),r.createElement("div",{className:"cornerstone-viewport-element",style:{height:"100%",width:"100%"},onContextMenu:e=>e.preventDefault(),onMouseDown:e=>e.preventDefault(),ref:b}),r.createElement(x,{viewportId:E,toolBarService:C,element:b.current,scrollbarHeight:I,servicesManager:p}),r.createElement(H,{enabledVPElement:S,viewportId:E,servicesManager:p})),r.createElement("div",{className:"absolute w-full"},L.viewportId===E&&r.createElement(m.Eg,{id:"viewport-notification",message:L.message,type:L.type,actions:L.actions,onSubmit:L.onSubmit,onOutsideClick:L.onOutsideClick})))}),G);function U(e,t,n,r,i,o,a){const c=t.current,{displaySetInstanceUID:m,SOPInstanceUID:u,frameNumber:p}=e;if(!u)return void console.warn("cannot jump in a non-acquisition plane measurements yet");const d=i.getDisplaySetByUID(m);o.setActiveViewportId(n);const v=(0,l.getEnabledElement)(c);if(v){const t=v.viewport;let n=0,r=!0;if(t instanceof l.StackViewport){n=t.getImageIds().findIndex((e=>{const{SOPInstanceUID:t,frameNumber:n}=(0,k.A)(e);return t===u&&(!p||p===n)}))}else{const{viewPlaneNormal:i}=e.metadata;n=d.images.findIndex((e=>e.SOPInstanceUID===u));const{viewPlaneNormal:o}=t.getCamera();i&&!l.utilities.isEqual(i.map(Math.abs),o.map(Math.abs))&&(r=!1)}if(!r||-1===n)return;s.utilities.jumpToSlice(c,{imageIndex:n}),s.annotation.selection.setAnnotationSelected(e.uid),z?.consume?.(),z=null}}W.displayName="OHIFCornerstoneViewport",W.defaultProps={isJumpToMeasurementDisabled:!1},W.propTypes={displaySets:a().array.isRequired,dataSource:a().object.isRequired,viewportOptions:a().object,displaySetOptions:a().arrayOf(a().any),servicesManager:a().object.isRequired,onElementEnabled:a().func,isJumpToMeasurementDisabled:a().bool,initialImageIdOrIndex:a().oneOfType([a().string,a().number])};const j=W}}]);
//# sourceMappingURL=889.bundle.6d716adbd7e59448cb4d.js.map